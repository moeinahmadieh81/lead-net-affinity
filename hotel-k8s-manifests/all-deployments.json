[
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "rsv",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "reservation",
        "availability-zone": "us-west-1b",
        "network-tier": "standard",
        "service": "rsv"
      }
    },
    "spec": {
      "replicas": 3,
      "selector": {
        "matchLabels": {
          "app": "rsv"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "rsv",
            "service": "rsv"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "rsv",
              "image": "reservation:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "150m",
                  "memory": "192Mi"
                },
                "limits": {
                  "cpu": "750m",
                  "memory": "768Mi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "reservation"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "rsv"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1b"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  },
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "prf",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "profile",
        "availability-zone": "us-west-1a",
        "network-tier": "standard",
        "service": "prf"
      }
    },
    "spec": {
      "replicas": 2,
      "selector": {
        "matchLabels": {
          "app": "prf"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "prf",
            "service": "prf"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "prf",
              "image": "profile:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "100m",
                  "memory": "128Mi"
                },
                "limits": {
                  "cpu": "500m",
                  "memory": "512Mi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "profile"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "prf"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1a"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  },
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "geo",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "geographic",
        "availability-zone": "us-west-1b",
        "network-tier": "standard",
        "service": "geo"
      }
    },
    "spec": {
      "replicas": 2,
      "selector": {
        "matchLabels": {
          "app": "geo"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "geo",
            "service": "geo"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "geo",
              "image": "geographic:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "100m",
                  "memory": "128Mi"
                },
                "limits": {
                  "cpu": "500m",
                  "memory": "512Mi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "geographic"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "geo"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1b"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  },
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "rte",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "rate",
        "availability-zone": "us-west-1c",
        "network-tier": "standard",
        "service": "rte"
      }
    },
    "spec": {
      "replicas": 2,
      "selector": {
        "matchLabels": {
          "app": "rte"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "rte",
            "service": "rte"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "rte",
              "image": "rate:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "100m",
                  "memory": "128Mi"
                },
                "limits": {
                  "cpu": "500m",
                  "memory": "512Mi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "rate"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "rte"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1c"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  },
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "fe",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "frontend",
        "availability-zone": "us-west-1a",
        "network-tier": "premium",
        "service": "fe"
      }
    },
    "spec": {
      "replicas": 9,
      "selector": {
        "matchLabels": {
          "app": "fe"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "fe",
            "service": "fe"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "fe",
              "image": "frontend:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "250m",
                  "memory": "320Mi"
                },
                "limits": {
                  "cpu": "1000m",
                  "memory": "1Gi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "frontend"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "fe"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "affinity": {
            "podAffinity": {
              "preferred_during_scheduling_ignored_during_execution": [
                {
                  "weight": 100,
                  "pod_affinity_term": {
                    "label_selector": {
                      "match_labels": {
                        "app": "recommendation",
                        "service": "rcm"
                      }
                    },
                    "topology_key": "kubernetes.io/hostname"
                  }
                },
                {
                  "weight": 99,
                  "pod_affinity_term": {
                    "label_selector": {
                      "match_labels": {
                        "app": "profile",
                        "service": "prf"
                      }
                    },
                    "topology_key": "kubernetes.io/hostname"
                  }
                },
                {
                  "weight": 98,
                  "pod_affinity_term": {
                    "label_selector": {
                      "match_labels": {
                        "app": "rate",
                        "service": "rte"
                      }
                    },
                    "topology_key": "kubernetes.io/hostname"
                  }
                },
                {
                  "weight": 97,
                  "pod_affinity_term": {
                    "label_selector": {
                      "match_labels": {
                        "app": "geographic",
                        "service": "geo"
                      }
                    },
                    "topology_key": "kubernetes.io/hostname"
                  }
                },
                {
                  "weight": 96,
                  "pod_affinity_term": {
                    "label_selector": {
                      "match_labels": {
                        "app": "user",
                        "service": "usr"
                      }
                    },
                    "topology_key": "kubernetes.io/hostname"
                  }
                },
                {
                  "weight": 95,
                  "pod_affinity_term": {
                    "label_selector": {
                      "match_labels": {
                        "app": "reservation",
                        "service": "rsv"
                      }
                    },
                    "topology_key": "kubernetes.io/hostname"
                  }
                }
              ]
            },
            "nodeAffinity": {
              "preferred_during_scheduling_ignored_during_execution": [
                {
                  "weight": 50,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "node.kubernetes.io/instance-type",
                        "operator": "In",
                        "values": [
                          "m5.large",
                          "m5.xlarge",
                          "c5.large",
                          "c5.xlarge"
                        ]
                      }
                    ]
                  }
                },
                {
                  "weight": 99,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "topology.kubernetes.io/zone",
                        "operator": "In",
                        "values": [
                          "us-west-1a"
                        ]
                      }
                    ]
                  }
                },
                {
                  "weight": 49,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "node.kubernetes.io/instance-type",
                        "operator": "In",
                        "values": [
                          "m5.large",
                          "m5.xlarge",
                          "c5.large",
                          "c5.xlarge"
                        ]
                      }
                    ]
                  }
                },
                {
                  "weight": 49,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "node.kubernetes.io/instance-type",
                        "operator": "In",
                        "values": [
                          "m5.large",
                          "m5.xlarge",
                          "c5.large",
                          "c5.xlarge"
                        ]
                      }
                    ]
                  }
                },
                {
                  "weight": 48,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "node.kubernetes.io/instance-type",
                        "operator": "In",
                        "values": [
                          "m5.large",
                          "m5.xlarge",
                          "c5.large",
                          "c5.xlarge"
                        ]
                      }
                    ]
                  }
                },
                {
                  "weight": 96,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "topology.kubernetes.io/zone",
                        "operator": "In",
                        "values": [
                          "us-west-1a"
                        ]
                      }
                    ]
                  }
                },
                {
                  "weight": 48,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "node.kubernetes.io/instance-type",
                        "operator": "In",
                        "values": [
                          "m5.large",
                          "m5.xlarge",
                          "c5.large",
                          "c5.xlarge"
                        ]
                      }
                    ]
                  }
                },
                {
                  "weight": 47,
                  "preference": {
                    "match_expressions": [
                      {
                        "key": "node.kubernetes.io/instance-type",
                        "operator": "In",
                        "values": [
                          "m5.large",
                          "m5.xlarge",
                          "c5.large",
                          "c5.xlarge"
                        ]
                      }
                    ]
                  }
                }
              ]
            }
          },
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1a"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  },
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "src",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "search",
        "availability-zone": "us-west-1b",
        "network-tier": "standard",
        "service": "src"
      }
    },
    "spec": {
      "replicas": 141,
      "selector": {
        "matchLabels": {
          "app": "src"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "src",
            "service": "src"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "src",
              "image": "search:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "200m",
                  "memory": "256Mi"
                },
                "limits": {
                  "cpu": "1000m",
                  "memory": "1Gi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "search"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "src"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1b"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  },
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "usr",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "user",
        "availability-zone": "us-west-1a",
        "network-tier": "standard",
        "service": "usr"
      }
    },
    "spec": {
      "replicas": 3,
      "selector": {
        "matchLabels": {
          "app": "usr"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "usr",
            "service": "usr"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "usr",
              "image": "user:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "150m",
                  "memory": "192Mi"
                },
                "limits": {
                  "cpu": "750m",
                  "memory": "768Mi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "user"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "usr"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1a"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  },
  {
    "apiVersion": "apps/v1",
    "kind": "Deployment",
    "metadata": {
      "name": "rcm",
      "namespace": "hotel-reservation",
      "labels": {
        "app": "recommendation",
        "availability-zone": "us-west-1c",
        "network-tier": "standard",
        "service": "rcm"
      }
    },
    "spec": {
      "replicas": 1066,
      "selector": {
        "matchLabels": {
          "app": "rcm"
        }
      },
      "template": {
        "metadata": {
          "labels": {
            "app": "rcm",
            "service": "rcm"
          }
        },
        "spec": {
          "containers": [
            {
              "name": "rcm",
              "image": "recommendation:latest",
              "ports": [
                {
                  "containerPort": 8080,
                  "name": "http"
                }
              ],
              "resources": {
                "requests": {
                  "cpu": "150m",
                  "memory": "192Mi"
                },
                "limits": {
                  "cpu": "750m",
                  "memory": "768Mi"
                }
              },
              "env": [
                {
                  "name": "SERVICE_NAME",
                  "value": "recommendation"
                },
                {
                  "name": "SERVICE_ID",
                  "value": "rcm"
                }
              ],
              "livenessProbe": {
                "httpGet": {
                  "path": "/health",
                  "port": 8080
                },
                "initialDelaySeconds": 30,
                "periodSeconds": 10
              },
              "readinessProbe": {
                "httpGet": {
                  "path": "/ready",
                  "port": 8080
                },
                "initialDelaySeconds": 5,
                "periodSeconds": 5
              }
            }
          ],
          "nodeSelector": {
            "topology.kubernetes.io/zone": "us-west-1c"
          },
          "restartPolicy": "Always"
        }
      },
      "strategy": {
        "type": "RollingUpdate"
      }
    }
  }
]
